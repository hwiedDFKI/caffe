<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>caffe: install_apt_debian</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">caffe
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('md_docs_install_apt_debian.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">install_apt_debian </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><hr/>
 <h2>title: "Installation: Debian" </h2>
<h1>Debian Installation</h1>
<p class="">Caffe packages are available for several Debian versions, as shown in the following chart:</p>
<div class="fragment"><div class="line">Your Distro     |  CPU_ONLY  |  CUDA  | Codename</div><div class="line">----------------+------------+--------+-------------------</div><div class="line">Debian/oldstable|     ✘      |   ✘    | Jessie (8.0)</div><div class="line">Debian/stable   |     ✔      |   ✔    | Stretch (9.0)</div><div class="line">Debian/testing  |     ✔      |   ✔    | Buster</div><div class="line">Debian/unstable |     ✔      |   ✔    | Buster</div></div><!-- fragment --><ul>
<li><code>✘</code> You should take a look at <a href="install_apt.html">Ubuntu installation instruction</a>.</li>
<li><code>✔</code> You can install caffe with a single command line following this guide.</li>
<li><a href="https://tracker.debian.org/pkg/caffe">Package status of CPU-only version</a></li>
<li><a href="https://tracker.debian.org/pkg/caffe-contrib">Package status of CUDA version</a></li>
</ul>
<p class="">Last update: 2017-07-08</p>
<h2>Binary installation with APT</h2>
<p class="">Apart from the installation methods based on source, Debian users can install pre-compiled Caffe packages from the official archive with APT.</p>
<p class="">Make sure that your <code>/etc/apt/sources.list</code> contains <code>contrib</code> and <code>non-free</code> sections if you want to install the CUDA version, for instance:</p>
<div class="fragment"><div class="line">deb http://ftp2.cn.debian.org/debian sid main contrib non-free</div></div><!-- fragment --><p class="">Then we update APT cache and directly install Caffe. Note, the cpu version and the cuda version cannot coexist.</p>
<div class="fragment"><div class="line">$ sudo apt update</div><div class="line">$ sudo apt install [ caffe-cpu | caffe-cuda ]</div><div class="line">$ caffe                                              # command line interface working</div><div class="line">$ python3 -c &#39;import caffe; print(caffe.__path__)&#39;   # python3 interface working</div></div><!-- fragment --><p class="">These Caffe packages should work for you out of box. However, the CUDA version may break if your NVIDIA driver and CUDA toolkit are not installed with APT.</p>
<h4>Customizing caffe packages</h4>
<p class="">Some users may need to customize the Caffe package. The way to customize the package is beyond this guide. Here is only a brief guide of producing the customized <code>.deb</code> packages.</p>
<p class="">Make sure that there is a <code>dec-src</code> source in your <code>/etc/apt/sources.list</code>, for instance:</p>
<div class="fragment"><div class="line">deb http://ftp2.cn.debian.org/debian sid main contrib non-free</div><div class="line">deb-src http://ftp2.cn.debian.org/debian sid main contrib non-free</div></div><!-- fragment --><p class="">Then we build caffe deb files with the following commands:</p>
<div class="fragment"><div class="line">$ sudo apt update</div><div class="line">$ sudo apt install build-essential debhelper devscripts  # standard package building tools</div><div class="line">$ sudo apt build-dep [ caffe-cpu | caffe-cuda ]          # the most elegant way to pull caffe build dependencies</div><div class="line">$ apt source [ caffe-cpu | caffe-cuda ]                  # download the source tarball and extract</div><div class="line">$ cd caffe-XXXX</div><div class="line">[ ... optional, customizing caffe code/build ... ]</div><div class="line">$ dch --local &quot;Modified XXX&quot;                             # bump package version and write changelog</div><div class="line">$ debuild -B -j4                                         # build caffe with 4 parallel jobs (similar to make -j4)</div><div class="line">[ ... building ...]</div><div class="line">$ debc                                                   # optional, if you want to check the package contents</div><div class="line">$ sudo debi                                              # optional, install the generated packages</div><div class="line">$ ls ../                                                 # optional, you will see the resulting packages</div></div><!-- fragment --><p class="">It is a BUG if the package failed to build without any change. The changelog will be installed at e.g. <code>/usr/share/doc/caffe-cpu/changelog.Debian.gz</code>.</p>
<h2>Source installation</h2>
<p class="">Source installation under Debian/unstable and Debian/testing is similar to that of Ubuntu, but here is a more elegant way to pull caffe build dependencies:</p>
<div class="fragment"><div class="line">$ sudo apt build-dep [ caffe-cpu | caffe-cuda ]</div></div><!-- fragment --><p class="">Note, this requires a <code>deb-src</code> entry in your <code>/etc/apt/sources.list</code>.</p>
<h4>Compiler Combinations</h4>
<p class="">Some users may find their favorate compiler doesn't work with CUDA.</p>
<div class="fragment"><div class="line">CXX compiler |  CUDA 7.5  |  CUDA 8.0  |  CUDA 9.0  |</div><div class="line">-------------+------------+------------+------------+</div><div class="line">GCC-8        |     ?      |     ?      |     ?      |</div><div class="line">GCC-7        |     ?      |     ?      |     ?      |</div><div class="line">GCC-6        |     ✘      |     ✘      |     ✔      |</div><div class="line">GCC-5        |     ✔ [1]  |     ✔      |     ✔      |</div><div class="line">-------------+------------+------------+------------+</div><div class="line">CLANG-4.0    |     ?      |     ?      |     ?      |</div><div class="line">CLANG-3.9    |     ✘      |     ✘      |     ✔      |</div><div class="line">CLANG-3.8    |     ?      |     ✔      |     ✔      |</div></div><!-- fragment --><p class=""><code>[1]</code> CUDA 7.5 's <code>host_config.h</code> must be patched before working with GCC-5.</p>
<p class=""><code>[2]</code> CUDA 9.0: <a href="https://devblogs.nvidia.com/parallelforall/cuda-9-features-revealed/">https://devblogs.nvidia.com/parallelforall/cuda-9-features-revealed/</a></p>
<p class="">BTW, please forget the GCC-4.X series, since its <code>libstdc++</code> ABI is not compatible with GCC-5's. You may encounter failure linking GCC-4.X object files against GCC-5 libraries. (See <a href="https://wiki.debian.org/GCC5">https://wiki.debian.org/GCC5</a> )</p>
<h2>Notes</h2>
<ul>
<li>Consider re-compiling OpenBLAS locally with optimization flags for sake of performance. This is highly recommended for any kind of production use, including academic research.</li>
<li>If you are installing <code>caffe-cuda</code>, APT will automatically pull some of the CUDA packages and the nvidia driver packages. Please be careful if you have manually installed or hacked nvidia driver or CUDA toolkit or any other related stuff, because in this case APT may fail.</li>
<li>Additionally, a manpage (<code>man caffe</code>) and a bash complementation script (<code>caffe &lt;TAB&gt;&lt;TAB&gt;</code>, <code>caffe train &lt;TAB&gt;&lt;TAB&gt;</code>) are provided. Both of the two files are still not merged into caffe master.</li>
<li>The python interface is Python 3 version: <code>python3-caffe-{cpu,cuda}</code>. No plan to support python2.</li>
<li>If you encountered any problem related to the packaging system (e.g. failed to install <code>caffe-*</code>), please report bug to Debian via Debian's bug tracking system. See <a href="https://www.debian.org/Bugs/">https://www.debian.org/Bugs/</a> . Patches and suggestions are also welcome.</li>
</ul>
<h2>FAQ</h2>
<ul>
<li>where is caffe-cudnn?</li>
</ul>
<p class="">CUDNN library seems not redistributable currently. If you really want the caffe-cudnn deb packages, the workaround is to install cudnn by yourself, and hack the packaging scripts, then build your customized package.</p>
<ul>
<li>I installed the CPU version. How can I switch to the CUDA version?</li>
</ul>
<p class=""><code>sudo apt install caffe-cuda</code>, apt's dependency resolver is smart enough to deal with this.</p>
<ul>
<li>Where are the examples, the models and other documentation stuff?</li>
</ul>
<div class="fragment"><div class="line">$ sudo apt install caffe-doc</div><div class="line">$ dpkg -L caffe-doc</div></div><!-- fragment --> </div></div><!-- PageDoc -->
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.15 </li>
  </ul>
</div>
</body>
</html>
